{"version":3,"file":"index.js","sourceRoot":"lib/","sources":["entry/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { defineComponent, h, ref, watch } from 'vue-demi'\nimport { Carousel } from 'ant-design-vue'\nimport { stylePrefix } from '../__builtins__/configs'\nimport { composeExport } from '../__builtins__/shared'\nimport { EntryItem } from './item'\n\n// Types\nimport type { VNode } from 'vue-demi'\nimport type { RemoteDataSource } from '../__builtins__/shared'\nimport type { EntryItemProps, onClick } from './item'\n\nexport interface RemoteEntryDataSource extends RemoteDataSource {}\n\nexport interface EntryProps {\n  /**\n   * 数据源\n   * TODO: remote dataSource and dataMapper\n   */\n  dataSource: EntryItemProps[] | RemoteEntryDataSource\n  /**\n   * 显示的列数\n   */\n  columns: number\n  /**\n   * 显示的行数\n   */\n  rows?: number\n}\n\nconst EntryContainer = defineComponent<EntryProps>({\n  name: 'Entry',\n  inheritAttrs: false,\n  props: {\n    dataSource: { type: [Array, Object], required: true },\n    columns: { type: Number, default: 6 },\n    rows: Number,\n  },\n  setup(props, { attrs, emit }) {\n    const prefixCls = `${stylePrefix}-entry`\n    const itemsRef = ref<EntryItemProps[]>([])\n\n    watch(\n      () => props.dataSource,\n      (value) => {\n        if (Array.isArray(value)) {\n          itemsRef.value = value\n        } else {\n          // TODO: request from remote\n        }\n      },\n      { immediate: true }\n    )\n\n    return () => {\n      const { rows, columns } = props\n      const items = itemsRef.value\n\n      const renderItems = (items: EntryItemProps[]): VNode => {\n        const cols = items.length < columns ? items.length : columns\n        const rows = items.length / cols + (items.length % cols === 0 ? 0 : 1)\n\n        return h(\n          'div',\n          {\n            class: [prefixCls, { [`${prefixCls}--mulit-lines`]: rows > 1 }],\n          },\n          items.map((item) =>\n            h(EntryItem, {\n              style: {\n                flexBasis: `${100 / cols}%`,\n              },\n              props: {\n                icon: item.icon,\n                text: item.text,\n                linkUrl: item.linkUrl,\n                blank: item.blank,\n              },\n              on: {\n                click: () => {\n                  const plain = JSON.parse(JSON.stringify(item))\n                  ;(attrs.onItemClick as onClick)?.(plain)\n                  emit('itemClick', plain)\n                },\n              },\n            })\n          )\n        )\n      }\n\n      const renderPagedItems = () => {\n        const length = rows! * columns\n        let index = 0\n        const itemVNodes: VNode[] = []\n        while (index < items.length - 1) {\n          const children = []\n          for (let i = index; i < index + length; i++) {\n            children.push(items[i])\n          }\n          itemVNodes.push(\n            h(\n              'div',\n              {\n                class: `${prefixCls}__paged-item`,\n              },\n              [renderItems(children.filter(Boolean))]\n            )\n          )\n          index += length\n        }\n\n        return itemVNodes\n      }\n\n      if (rows && rows * columns < items.length) {\n        return h(\n          Carousel,\n          {\n            props: {\n              autoplay: false,\n              dotsClass: `${prefixCls}__paged-dots`,\n            },\n          },\n          [renderPagedItems()]\n        )\n      } else {\n        return renderItems(items)\n      }\n    }\n  },\n})\n\nexport const Entry = composeExport(EntryContainer, {\n  Item: EntryItem,\n})\n\nexport default Entry\n"]}